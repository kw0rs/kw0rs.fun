<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тирлист энергетиков - Академия Кворса</title>
    
    <!-- Open Graph -->
    <meta property="og:title" content="Тирлист энергетиков - Академия Кворса">
    <meta property="og:description" content="Рейтинг энергетических напитков от Вильяма Кворса">
    <meta property="og:image" content="https://kw0rs.uno/icon/williamkw0rs.jpg">
    <meta property="og:url" content="https://kw0rs.uno/energy">
    <meta property="og:type" content="website">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icon/favicon-16x16.png">
    <link rel="apple-touch-icon" href="/icon/apple-touch-icon.png">
    <link rel="shortcut icon" href="/icon/favicon.ico">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 20px;
            display: block;
            border: 3px solid #333;
        }
        
        h1 {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #ffffff;
        }
        
        .subtitle {
            font-size: 16px;
            color: #888;
            margin-bottom: 20px;
        }
        
        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            color: #ffffff;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .back-btn:hover {
            background: #2a2a2a;
            border-color: #555;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #888;
        }
        
        .tier-container {
            margin-bottom: 30px;
        }
        
        .tier {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 16px;
        }
        
        .tier-header {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid #333;
        }
        
        .tier-label {
            font-size: 24px;
            font-weight: 700;
            width: auto;
            min-width: 60px;
            max-width: 150px;
            text-align: center;
            padding: 8px 16px;
            border-radius: 8px;
            margin-right: 20px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .tier-S .tier-label { background: #ff4757; color: #fff; }
        .tier-A .tier-label { background: #ffa502; color: #fff; }
        .tier-B .tier-label { background: #ffd700; color: #000; }
        .tier-C .tier-label { background: #7bed9f; color: #000; }
        .tier-D .tier-label { background: #70a1ff; color: #fff; }
        .tier-F .tier-label { background: #747d8c; color: #fff; }
        .tier-\? .tier-label { background: #2d3436; color: #fff; }
        
        .tier-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 16px;
            padding: 20px;
            min-height: 80px;
        }
        
        .item {
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .item:hover {
            transform: translateY(-4px);
            border-color: #555;
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
        }
        
        .item-image {
            width: 100%;
            height: 120px;
            object-fit: contain;
            margin-bottom: 8px;
            border-radius: 4px;
            background: #000;
        }
        
        .item-name {
            font-size: 14px;
            font-weight: 500;
            color: #ffffff;
            margin-bottom: 2px;
        }
        
        .item-brand {
            font-size: 11px;
            color: #666;
            margin-bottom: 4px;
        }
        
        .item-rating {
            font-size: 12px;
            color: #888;
        }
        
        .empty-tier {
            color: #555;
            text-align: center;
            padding: 20px;
            font-style: italic;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 24px;
            }
            
            .tier-items {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 12px;
                padding: 16px;
            }
            
            .tier-label {
                font-size: 16px;
                width: auto;
                min-width: 50px;
                margin-right: 12px;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="https://kw0rs.uno/icon/williamkw0rs.jpg" alt="William Kwors" class="logo">
            <h1>⚡ Тирлист энергетиков</h1>
            <p class="subtitle">Рейтинг энергетических напитков от Вильяма Кворса</p>
            <a href="/" class="back-btn">← Назад на главную</a>
        </header>
        
        <div id="content" class="loading">
            Загрузка данных...
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script>
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/1_Z97l6DZHq57gYrk_LiQTDc3Qr60yNxSznQQeA_EzEQ/export?format=csv';
        
        const tierOrder = ['S', 'A', 'B', 'C', 'D', 'F', '?'];
        
        function loadData() {
            Papa.parse(SHEET_URL, {
                download: true,
                header: true,
                complete: function(results) {
                    renderTierList(results.data);
                },
                error: function(error) {
                    document.getElementById('content').innerHTML = 
                        '<div style="color: #ff4757; text-align: center;">Ошибка загрузки данных. Проверьте ссылку на таблицу.</div>';
                    console.error('Error:', error);
                }
            });
        }
        
        function renderTierList(data) {
            // Группируем по тирам
            const tiers = {};
            tierOrder.forEach(tier => {
                tiers[tier] = [];
            });
            
            data.forEach(row => {
                // Колонки: Название, Бренд, Оценка, Картинка
                const name = row['Название'] || row['название'] || row['Name'] || '';
                const brand = row['Бренд'] || row['бренд'] || row['Brand'] || '';
                let rating = row['Оценка'] || row['оценка'] || row['Rating'] || '';
                const image = row['Картинка'] || row['картинка'] || row['Image'] || '';
                
                if (name && rating) {
                    rating = rating.toString().trim().toUpperCase();
                    // Если тира нет в списке, добавляем в "?"
                    if (!tiers[rating]) {
                        rating = '?';
                    }
                    tiers[rating].push({ name, brand, rating: rating, image });
                }
            });
            
            // Рендерим HTML
            let html = '<div class="tier-container">';
            
            tierOrder.forEach(tier => {
                const displayLabel = tier === '?' ? '?' : tier;
                const tierClass = tier === '?' ? '?' : tier;
                
                html += `
                    <div class="tier tier-${tierClass}">
                        <div class="tier-header">
                            <div class="tier-label" title="${tier === '?' ? 'Не оценено' : 'Tier ' + tier}">${displayLabel}</div>
                            ${tier === '?' ? '<span style="color: #888; font-size: 14px;">Не оценено</span>' : ''}
                        </div>
                        <div class="tier-items">
                `;
                
                if (tiers[tier].length > 0) {
                    tiers[tier].forEach(item => {
                        html += `
                            <div class="item">
                                <img src="${item.image || 'https://via.placeholder.com/120x120?text=No+Image'}" 
                                     alt="${item.name}" 
                                     class="item-image"
                                     onerror="this.src='https://via.placeholder.com/120x120?text=No+Image'">
                                <div class="item-name">${item.name}</div>
                                ${item.brand ? `<div class="item-brand">${item.brand}</div>` : ''}
                                <div class="item-rating">Tier ${item.rating}</div>
                            </div>
                        `;
                    });
                } else {
                    html += '<div class="empty-tier">Пусто</div>';
                }
                
                html += `
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            document.getElementById('content').innerHTML = html;
        }
        
        // Загружаем данные при загрузке страницы
        loadData();
    </script>
</body>
</html>
