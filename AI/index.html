<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞–π–Ω–∫—Ä–∞—Ñ—Ç 2D - –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
            font-family: 'Courier New', monospace;
            overflow: hidden;
            user-select: none;
        }

        .game-interface {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .top-bar {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
        }

        .stats {
            display: flex;
            gap: 20px;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .health-bar, .hunger-bar, .xp-bar {
            width: 100px;
            height: 10px;
            background: #333;
            border: 1px solid #fff;
            position: relative;
        }

        .health-fill {
            height: 100%;
            background: #ff4444;
            transition: width 0.3s;
        }

        .hunger-fill {
            height: 100%;
            background: #ff8800;
            transition: width 0.3s;
        }

        .xp-fill {
            height: 100%;
            background: #00ff00;
            transition: width 0.3s;
        }

        .game-world {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: #87CEEB;
        }

        .world-container {
            position: absolute;
            width: 3200px;
            height: 1600px;
            transition: transform 0.1s ease;
        }

        .player {
            width: 32px;
            height: 32px;
            background: #8B4513;
            position: absolute;
            border: 2px solid #654321;
            z-index: 100;
            transition: all 0.1s ease;
        }

        .player.moving {
            animation: playerWalk 0.4s infinite;
        }

        @keyframes playerWalk {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-2px); }
        }

        .block {
            width: 32px;
            height: 32px;
            position: absolute;
            border: 1px solid rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }

        .block:hover {
            filter: brightness(1.2);
            transform: scale(1.05);
        }

        .grass { background: #228B22; }
        .dirt { background: #8B4513; }
        .stone { background: #696969; }
        .wood { background: #DEB887; }
        .leaves { background: #32CD32; }
        .water { background: #4169E1; animation: water 2s infinite; }
        .sand { background: #F4A460; }
        .coal { background: #2F4F4F; }
        .iron { background: #C0C0C0; }
        .gold { background: #FFD700; }
        .diamond { background: #B9F2FF; }
        .bedrock { background: #1C1C1C; }

        @keyframes water {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .mob {
            width: 28px;
            height: 28px;
            position: absolute;
            z-index: 50;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .zombie {
            background: #228B22;
            border: 2px solid #006400;
        }

        .skeleton {
            background: #F5F5DC;
            border: 2px solid #D3D3D3;
        }

        .creeper {
            background: #32CD32;
            border: 2px solid #228B22;
        }

        .item-drop {
            width: 16px;
            height: 16px;
            position: absolute;
            z-index: 75;
            border-radius: 50%;
            animation: itemBob 2s infinite;
        }

        @keyframes itemBob {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-4px); }
        }

        .bottom-interface {
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .hotbar {
            display: flex;
            gap: 2px;
        }

        .hotbar-slot {
            width: 50px;
            height: 50px;
            border: 2px solid #666;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }

        .hotbar-slot.selected {
            border-color: #fff;
            background: #555;
            transform: scale(1.1);
        }

        .hotbar-slot:hover {
            background: #444;
        }

        .slot-icon {
            font-size: 20px;
        }

        .slot-count {
            position: absolute;
            bottom: 2px;
            right: 2px;
            color: white;
            font-size: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 1px 3px;
            border-radius: 2px;
        }

        .crafting-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            display: none;
            z-index: 2000;
        }

        .crafting-grid {
            display: grid;
            grid-template-columns: repeat(3, 50px);
            gap: 5px;
            margin: 10px 0;
        }

        .craft-slot {
            width: 50px;
            height: 50px;
            border: 2px solid #666;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .minimap {
            position: fixed;
            top: 60px;
            right: 20px;
            width: 150px;
            height: 150px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #fff;
            border-radius: 10px;
            z-index: 1000;
        }

        .minimap-content {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .minimap-player {
            width: 4px;
            height: 4px;
            background: #ff0000;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
        }

        .day-night-cycle {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 500;
            transition: background 2s ease;
        }

        .night {
            background: rgba(0, 0, 50, 0.6);
        }

        .controls-help {
            position: fixed;
            bottom: 80px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #fff;
            border-radius: 50%;
            pointer-events: none;
            z-index: 200;
        }

        .damage-text {
            position: absolute;
            color: #ff0000;
            font-weight: bold;
            font-size: 14px;
            z-index: 300;
            pointer-events: none;
            animation: damageFloat 1s ease-out forwards;
        }

        @keyframes damageFloat {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-30px); }
        }
    </style>
</head>
<body>
    <div class="game-interface">
        <div class="top-bar">
            <div class="stats">
                <div class="stat">
                    ‚ù§Ô∏è <div class="health-bar"><div class="health-fill" id="healthFill"></div></div>
                </div>
                <div class="stat">
                    üçñ <div class="hunger-bar"><div class="hunger-fill" id="hungerFill"></div></div>
                </div>
                <div class="stat">
                    ‚≠ê <div class="xp-bar"><div class="xp-fill" id="xpFill"></div></div>
                </div>
            </div>
            <div class="game-info">
                <span>–î–µ–Ω—å: <span id="dayCounter">1</span></span>
                <span>–í—Ä–µ–º—è: <span id="timeDisplay">06:00</span></span>
                <span>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: <span id="coordinates">0, 0</span></span>
            </div>
        </div>

        <div class="game-world" id="gameWorld">
            <div class="world-container" id="worldContainer">
                <div class="player" id="player"></div>
            </div>
        </div>

        <div class="day-night-cycle" id="dayNightCycle"></div>

        <div class="minimap">
            <div class="minimap-content" id="minimapContent">
                <div class="minimap-player"></div>
            </div>
        </div>

        <div class="bottom-interface">
            <div class="hotbar" id="hotbar">
                <div class="hotbar-slot selected" data-item="dirt">
                    <span class="slot-icon">üü´</span>
                    <span class="slot-count">64</span>
                </div>
                <div class="hotbar-slot" data-item="stone">
                    <span class="slot-icon">üóø</span>
                    <span class="slot-count">32</span>
                </div>
                <div class="hotbar-slot" data-item="wood">
                    <span class="slot-icon">ü™µ</span>
                    <span class="slot-count">16</span>
                </div>
                <div class="hotbar-slot" data-item="pickaxe">
                    <span class="slot-icon">‚õèÔ∏è</span>
                    <span class="slot-count">1</span>
                </div>
                <div class="hotbar-slot" data-item="sword">
                    <span class="slot-icon">‚öîÔ∏è</span>
                    <span class="slot-count">1</span>
                </div>
                <div class="hotbar-slot" data-item="food">
                    <span class="slot-icon">üçñ</span>
                    <span class="slot-count">8</span>
                </div>
                <div class="hotbar-slot" data-item="torch">
                    <span class="slot-icon">üïØÔ∏è</span>
                    <span class="slot-count">12</span>
                </div>
                <div class="hotbar-slot" data-item="water">
                    <span class="slot-icon">üíß</span>
                    <span class="slot-count">‚àû</span>
                </div>
                <div class="hotbar-slot" data-item="tnt">
                    <span class="slot-icon">üí£</span>
                    <span class="slot-count">3</span>
                </div>
            </div>
        </div>

        <div class="crafting-panel" id="craftingPanel">
            <h3>–ö—Ä–∞—Ñ—Ç</h3>
            <div class="crafting-grid" id="craftingGrid">
                <div class="craft-slot"></div>
                <div class="craft-slot"></div>
                <div class="craft-slot"></div>
                <div class="craft-slot"></div>
                <div class="craft-slot"></div>
                <div class="craft-slot"></div>
                <div class="craft-slot"></div>
                <div class="craft-slot"></div>
                <div class="craft-slot"></div>
            </div>
            <div class="craft-result">
                <div class="craft-slot"></div>
            </div>
            <button onclick="closeCrafting()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>

        <div class="controls-help">
            <div>WASD - –î–≤–∏–∂–µ–Ω–∏–µ</div>
            <div>–õ–ö–ú - –†–∞–∑—Ä—É—à–∏—Ç—å/–ê—Ç–∞–∫–æ–≤–∞—Ç—å</div>
            <div>–ü–ö–ú - –ü–æ—Å—Ç–∞–≤–∏—Ç—å –±–ª–æ–∫</div>
            <div>E - –ö—Ä–∞—Ñ—Ç</div>
            <div>1-9 - –í—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞</div>
            <div>Shift - –ë–µ–≥</div>
            <div>Space - –ü—Ä—ã–∂–æ–∫</div>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        const gameWorld = document.getElementById('gameWorld');
        const worldContainer = document.getElementById('worldContainer');
        const player = document.getElementById('player');
        const hotbar = document.getElementById('hotbar');
        const craftingPanel = document.getElementById('craftingPanel');
        const dayNightCycle = document.getElementById('dayNightCycle');

        let playerX = 1600;
        let playerY = 800;
        let cameraX = 0;
        let cameraY = 0;
        let selectedSlot = 0;
        let isMoving = false;
        let isRunning = false;

        // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let gameState = {
            health: 100,
            hunger: 100,
            xp: 0,
            day: 1,
            time: 360, // –º–∏–Ω—É—Ç—ã —Å –Ω–∞—á–∞–ª–∞ –¥–Ω—è (6:00)
            inventory: {},
            blocks: new Map(),
            mobs: [],
            items: [],
            particles: []
        };

        // –¢–∏–ø—ã –±–ª–æ–∫–æ–≤ –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞
        const blockTypes = {
            grass: { hardness: 1, tool: 'shovel', drops: ['dirt'] },
            dirt: { hardness: 1, tool: 'shovel', drops: ['dirt'] },
            stone: { hardness: 3, tool: 'pickaxe', drops: ['stone'] },
            wood: { hardness: 2, tool: 'axe', drops: ['wood'] },
            leaves: { hardness: 0.5, tool: 'any', drops: ['leaves', 'apple'] },
            water: { hardness: 0, tool: 'bucket', drops: [] },
            sand: { hardness: 1, tool: 'shovel', drops: ['sand'] },
            coal: { hardness: 4, tool: 'pickaxe', drops: ['coal'] },
            iron: { hardness: 6, tool: 'pickaxe', drops: ['iron_ore'] },
            gold: { hardness: 8, tool: 'pickaxe', drops: ['gold_ore'] },
            diamond: { hardness: 10, tool: 'pickaxe', drops: ['diamond'] },
            bedrock: { hardness: -1, tool: 'none', drops: [] }
        };

        // –†–µ—Ü–µ–ø—Ç—ã –∫—Ä–∞—Ñ—Ç–∞
        const recipes = {
            'wood,wood,wood,wood': 'workbench',
            'wood': 'stick,stick,stick,stick',
            'stick,stick,stone': 'pickaxe',
            'stick,stick,wood': 'sword'
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            generateWorld();
            spawnMobs();
            updateCamera();
            gameLoop();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            gameState.inventory = {
                dirt: 64, stone: 32, wood: 16, pickaxe: 1,
                sword: 1, food: 8, torch: 12, water: 999, tnt: 3
            };
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏—Ä–∞
        function generateWorld() {
            const worldWidth = 100;
            const worldHeight = 50;
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞–Ω–¥—à–∞—Ñ—Ç–∞
            for (let x = 0; x < worldWidth; x++) {
                let height = Math.floor(25 + Math.sin(x * 0.1) * 5 + Math.random() * 3);
                
                // –ö–æ—Ä–µ–Ω–Ω–∞—è –ø–æ—Ä–æ–¥–∞
                for (let y = 45; y < worldHeight; y++) {
                    createBlock('bedrock', x * 32, y * 32);
                }
                
                // –ö–∞–º–µ–Ω—å
                for (let y = height + 5; y < 45; y++) {
                    let blockType = 'stone';
                    if (Math.random() < 0.05) blockType = 'coal';
                    if (Math.random() < 0.02) blockType = 'iron';
                    if (Math.random() < 0.005) blockType = 'gold';
                    if (Math.random() < 0.001) blockType = 'diamond';
                    createBlock(blockType, x * 32, y * 32);
                }
                
                // –ó–µ–º–ª—è
                for (let y = height; y < height + 5; y++) {
                    createBlock('dirt', x * 32, y * 32);
                }
                
                // –¢—Ä–∞–≤–∞
                createBlock('grass', x * 32, height * 32);
                
                // –î–µ—Ä–µ–≤—å—è
                if (Math.random() < 0.1 && x > 5 && x < worldWidth - 5) {
                    let treeHeight = 3 + Math.floor(Math.random() * 3);
                    for (let i = 0; i < treeHeight; i++) {
                        createBlock('wood', x * 32, (height - 1 - i) * 32);
                    }
                    // –õ–∏—Å—Ç–≤–∞
                    for (let lx = -2; lx <= 2; lx++) {
                        for (let ly = -2; ly <= 1; ly++) {
                            if (Math.random() < 0.7) {
                                createBlock('leaves', (x + lx) * 32, (height - treeHeight - ly) * 32);
                            }
                        }
                    }
                }
                
                // –í–æ–¥–∞
                if (Math.random() < 0.05) {
                    let waterWidth = 2 + Math.floor(Math.random() * 4);
                    for (let wx = 0; wx < waterWidth; wx++) {
                        if (x + wx < worldWidth) {
                            createBlock('water', (x + wx) * 32, (height + 1) * 32);
                        }
                    }
                }
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ–∫–∞
        function createBlock(type, x, y) {
            const block = document.createElement('div');
            block.className = `block ${type}`;
            block.style.left = x + 'px';
            block.style.top = y + 'px';
            block.dataset.type = type;
            worldContainer.appendChild(block);
            gameState.blocks.set(`${x},${y}`, { type, element: block });
        }

        // –°–ø–∞–≤–Ω –º–æ–±–æ–≤
        function spawnMobs() {
            for (let i = 0; i < 20; i++) {
                spawnMob();
            }
        }

        function spawnMob() {
            const types = ['zombie', 'skeleton', 'creeper'];
            const type = types[Math.floor(Math.random() * types.length)];
            const x = Math.random() * 3000;
            const y = Math.random() * 1400;
            
            const mob = document.createElement('div');
            mob.className = `mob ${type}`;
            mob.style.left = x + 'px';
            mob.style.top = y + 'px';
            worldContainer.appendChild(mob);
            
            gameState.mobs.push({
                element: mob,
                type: type,
                x: x,
                y: y,
                health: type === 'creeper' ? 20 : 30,
                speed: 0.5 + Math.random() * 0.5,
                direction: Math.random() * Math.PI * 2,
                lastDirectionChange: Date.now()
            });
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        const keys = {};
        
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
            
            // –í—ã–±–æ—Ä —Å–ª–æ—Ç–∞ —Ö–æ—Ç–±–∞—Ä–∞
            if (e.key >= '1' && e.key <= '9') {
                selectSlot(parseInt(e.key) - 1);
            }
            
            // –ö—Ä–∞—Ñ—Ç
            if (e.key.toLowerCase() === 'e') {
                toggleCrafting();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è
        function handleMovement() {
            let moveX = 0;
            let moveY = 0;
            const speed = keys['shift'] ? 4 : 2;
            
            if (keys['w']) moveY -= speed;
            if (keys['s']) moveY += speed;
            if (keys['a']) moveX -= speed;
            if (keys['d']) moveX += speed;
            
            if (moveX !== 0 || moveY !== 0) {
                isMoving = true;
                player.classList.add('moving');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π
                const newX = Math.max(0, Math.min(3168, playerX + moveX));
                const newY = Math.max(0, Math.min(1568, playerY + moveY));
                
                if (!checkCollision(newX, newY)) {
                    playerX = newX;
                    playerY = newY;
                    updateCamera();
                }
            } else {
                isMoving = false;
                player.classList.remove('moving');
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π
        function checkCollision(x, y) {
            const blockX = Math.floor(x / 32) * 32;
            const blockY = Math.floor(y / 32) * 32;
            const block = gameState.blocks.get(`${blockX},${blockY}`);
            return block && block.type !== 'water';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
        function updateCamera() {
            cameraX = playerX - window.innerWidth / 2;
            cameraY = playerY - window.innerHeight / 2;
            
            cameraX = Math.max(0, Math.min(3200 - window.innerWidth, cameraX));
            cameraY = Math.max(0, Math.min(1600 - window.innerHeight, cameraY));
            
            worldContainer.style.transform = `translate(${-cameraX}px, ${-cameraY}px)`;
            player.style.left = playerX + 'px';
            player.style.top = playerY + 'px';
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
            document.getElementById('coordinates').textContent = 
                `${Math.floor(playerX/32)}, ${Math.floor(playerY/32)}`;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏
        gameWorld.addEventListener('mousedown', (e) => {
            const rect = gameWorld.getBoundingClientRect();
            const worldX = e.clientX - rect.left + cameraX;
            const worldY = e.clientY - rect.top + cameraY;
            const blockX = Math.floor(worldX / 32) * 32;
            const blockY = Math.floor(worldY / 32) * 32;
            
            if (e.button === 0) { // –õ–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞
                destroyBlock(blockX, blockY);
                attackMobs(worldX, worldY);
            } else if (e.button === 2) { // –ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞
                placeBlock(blockX, blockY);
            }
        });

        gameWorld.addEventListener('contextmenu', (e) => e.preventDefault());

        // –†–∞–∑—Ä—É—à–µ–Ω–∏–µ –±–ª–æ–∫–∞
        function destroyBlock(x, y) {
            const block = gameState.blocks.get(`${x},${y}`);
            if (block && block.type !== 'bedrock') {
                const blockType = blockTypes[block.type];
                
                // –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
                createParticles(x + 16, y + 16, block.type);
                
                // –î—Ä–æ–ø –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                blockType.drops.forEach(drop => {
                    if (Math.random() < 0.8) {
                        createItemDrop(drop, x + 16, y + 16);
                    }
                });
                
                block.element.remove();
                gameState.blocks.delete(`${x},${y}`);
                
                // –û–ø—ã—Ç
                gameState.xp += 1;
                updateUI();
            }
        }

        // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –±–ª–æ–∫–∞
        function placeBlock(x, y) {
            const selectedItem = getSelectedItem();
            if (selectedItem && gameState.inventory[selectedItem] > 0) {
                if (!gameState.blocks.has(`${x},${y}`) && 
                    !(playerX >= x && playerX < x + 32 && playerY >= y && playerY < y + 32)) {
                    
                    createBlock(selectedItem, x, y);
                    gameState.inventory[selectedItem]--;
                    updateHotbar();
                }
            }
        }

        // –ê—Ç–∞–∫–∞ –º–æ–±–æ–≤
        function attackMobs(x, y) {
            gameState.mobs.forEach((mob, index) => {
                const distance = Math.sqrt((mob.x - x) ** 2 + (mob.y - y) ** 2);
                if (distance < 50) {
                    mob.health -= 10;
                    createDamageText(mob.x, mob.y, 10);
                    
                    if (mob.health <= 0) {
                        mob.element.remove();
                        gameState.mobs.splice(index, 1);
                        gameState.xp += 5;
                        createItemDrop('meat', mob.x, mob.y);
                    }
                }
            });
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
        function createParticles(x, y, type) {
            for (let i = 0; i < 8; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = x + Math.random() * 20 - 10 + 'px';
                particle.style.top = y + Math.random() * 20 - 10 + 'px';
                particle.style.background = getBlockColor(type);
                worldContainer.appendChild(particle);
                
                setTimeout(() => particle.remove(), 1000);
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –¥—Ä–æ–ø–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
        function createItemDrop(item, x, y) {
            const drop = document.createElement('div');
            drop.className = 'item-drop';
            drop.style.left = x + 'px';
            drop.style.top = y + 'px';
            drop.style.background = getItemColor(item);
            worldContainer.appendChild(drop);
            
            gameState.items.push({
                element: drop,
                type: item,
                x: x,
                y: y,
                pickupTime: Date.now() + 1000
            });
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —É—Ä–æ–Ω–∞
        function createDamageText(x, y, damage) {
            const text = document.createElement('div');
            text.className = 'damage-text';
            text.textContent = `-${damage}`;
            text.style.left = x + 'px';
            text.style.top = y + 'px';
            worldContainer.appendChild(text);
            
            setTimeout(() => text.remove(), 1000);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–±–æ–≤
        function updateMobs() {
            gameState.mobs.forEach(mob => {
                // –ò–ò –º–æ–±–æ–≤
                if (Date.now() - mob.lastDirectionChange > 2000) {
                    mob.direction = Math.random() * Math.PI * 2;
                    mob.lastDirectionChange = Date.now();
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –∫ –∏–≥—Ä–æ–∫—É –µ—Å–ª–∏ –±–ª–∏–∑–∫–æ
                const distanceToPlayer = Math.sqrt((mob.x - playerX) ** 2 + (mob.y - playerY) ** 2);
                if (distanceToPlayer < 200) {
                    mob.direction = Math.atan2(playerY - mob.y, playerX - mob.x);
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ
                mob.x += Math.cos(mob.direction) * mob.speed;
                mob.y += Math.sin(mob.direction) * mob.speed;
                
                // –ì—Ä–∞–Ω–∏—Ü—ã –º–∏—Ä–∞
                mob.x = Math.max(0, Math.min(3168, mob.x));
                mob.y = Math.max(0, Math.min(1568, mob.y));
                
                mob.element.style.left = mob.x + 'px';
                mob.element.style.top = mob.y + 'px';
                
                // –ê—Ç–∞–∫–∞ –∏–≥—Ä–æ–∫–∞
                if (distanceToPlayer < 40) {
                    gameState.health -= 0.1;
                    if (gameState.health <= 0) {
                        respawnPlayer();
                    }
                }
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
        function updateItems() {
            gameState.items.forEach((item, index) => {
                // –ü–æ–¥–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                const distance = Math.sqrt((item.x - playerX) ** 2 + (item.y - playerY) ** 2);
                if (distance < 32 && Date.now() > item.pickupTime) {
                    gameState.inventory[item.type] = (gameState.inventory[item.type] || 0) + 1;
                    item.element.remove();
                    gameState.items.splice(index, 1);
                    updateHotbar();
                }
            });
        }

        // –¶–∏–∫–ª –¥–µ–Ω—å/–Ω–æ—á—å
        function updateDayNightCycle() {
            gameState.time += 0.1;
            if (gameState.time >= 1440) { // 24 —á–∞—Å–∞
                gameState.time = 0;
                gameState.day++;
            }
            
            const hours = Math.floor(gameState.time / 60);
            const minutes = Math.floor(gameState.time % 60);
            document.getElementById('timeDisplay').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
            document.getElementById('dayCounter').textContent = gameState.day;
            
            // –ù–æ—á–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç
            if (hours >= 20 || hours < 6) {
                dayNightCycle.classList.add('night');
                // –°–ø–∞–≤–Ω –±–æ–ª—å—à–µ –º–æ–±–æ–≤ –Ω–æ—á—å—é
                if (Math.random() < 0.01 && gameState.mobs.length < 50) {
                    spawnMob();
                }
            } else {
                dayNightCycle.classList.remove('night');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            document.getElementById('healthFill').style.width = gameState.health + '%';
            document.getElementById('hungerFill').style.width = gameState.hunger + '%';
            document.getElementById('xpFill').style.width = (gameState.xp % 100) + '%';
        }

        // –í—ã–±–æ—Ä —Å–ª–æ—Ç–∞
        function selectSlot(index) {
            document.querySelectorAll('.hotbar-slot').forEach((slot, i) => {
                slot.classList.toggle('selected', i === index);
            });
            selectedSlot = index;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞
        function getSelectedItem() {
            const slot = document.querySelectorAll('.hotbar-slot')[selectedSlot];
            return slot ? slot.dataset.item : null;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–æ—Ç–±–∞—Ä–∞
        function updateHotbar() {
            document.querySelectorAll('.hotbar-slot').forEach(slot => {
                const item = slot.dataset.item;
                const count = gameState.inventory[item] || 0;
                const countElement = slot.querySelector('.slot-count');
                if (countElement) {
                    countElement.textContent = count === 999 ? '‚àû' : count;
                }
            });
        }

        // –ö—Ä–∞—Ñ—Ç
        function toggleCrafting() {
            const panel = document.getElementById('craftingPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function closeCrafting() {
            document.getElementById('craftingPanel').style.display = 'none';
        }

        // –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
        function respawnPlayer() {
            gameState.health = 100;
            gameState.hunger = 100;
            playerX = 1600;
            playerY = 800;
            updateCamera();
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getBlockColor(type) {
            const colors = {
                grass: '#228B22', dirt: '#8B4513', stone: '#696969',
                wood: '#DEB887', leaves: '#32CD32', water: '#4169E1'
            };
            return colors[type] || '#fff';
        }

        function getItemColor(item) {
            const colors = {
                dirt: '#8B4513', stone: '#696969', wood: '#DEB887',
                meat: '#ff4444', coal: '#2F4F4F'
            };
            return colors[item] || '#fff';
        }

        // –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function gameLoop() {
            handleMovement();
            updateMobs();
            updateItems();
            updateDayNightCycle();
            updateUI();
            
            // –ì–æ–ª–æ–¥
            gameState.hunger -= 0.01;
            if (gameState.hunger <= 0) {
                gameState.health -= 0.1;
            }
            
            requestAnimationFrame(gameLoop);
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        initGame();
    </script>
</body>
</html>
